<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    html,
    body {
      height: 100%
    }

    #stats {
      position: relative;
      width: 100%;
      height: 80px;
    }
  </style>
</head>

<body>

  <div>
    <div id="stats"></div>
  </div>

  <div class="space-y-4 p-4">
    <button id="play-btn" type="button"
      class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">
      Play
    </button>

    <div class="w-[640px]">
      <canvas id="o"></canvas>
      <video id="v" width="640" height="360" controls>
        <source src="/video.mp4" type="video/mp4">
        This browser doesn't support video tag.
      </video>
    </div>

    <div class="w-[640px] h-[60px] bg-gray-400 overflow-hidden relative">
      <div id="fullbar" class="absolute top-0 h-[60px] flex" style="left: 0px">
        <div style="width: 320px;"></div>
        <div id="bar" class="bg-gradient-to-r from-cyan-500 to-blue-500 overflow-hidden relative" style="width: 640px;">
        </div>
        <div style="width: 320px;"></div>
      </div>
      <div class="absolute top-2 left-[320px]">
        <span class="-ml-6 inline-block h-12 w-12 rounded-full overflow-hidden bg-gray-100 shadow-sm opacity-70">
          <svg class="h-full w-full text-gray-300" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
        </span>
      </div>
    </div>

    <div>
      <canvas id="output"></canvas>
      <video id="video" class="hidden" playsinline style="
        -webkit-transform: scaleX(-1);
        transform: scaleX(-1);
        visibility: hidden;
        width: auto;
        height: auto;
        ">
      </video>
    </div>

    <div>
      <video class="hidden" height="480" width="640" id="webcam"
        style="-webkit-transform: scaleX(-1); transform: scaleX(-1);">
      </video>

      <canvas id="c" width="640" height="480" style="border:1px solid #ccc"></canvas>

      <div id="scatter-gl-container"></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.6/dat.gui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r16/Stats.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.8.0/dist/tf.min.js"> </script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl@3.8.0/dist/tf-backend-webgl.min.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-wasm@3.8.0/dist/tf-backend-wasm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection/dist/pose-detection.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.106.2/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/scatter-gl@0.0.1/lib/scatter-gl.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fabric@5.2.1/dist/fabric.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
  <script>
    console.log(_.sum([1, 2, 3]))
  </script>
  <script type="module" src="js/index.js"></script>
  <script>
    $('#play-btn').click(() => {
      const duration = $('#v').get(0).duration

      // disable button
      $("#play-btn").prop('disabled', true);

      // 秒數
      console.log('duration', duration)

      // 寬度
      const width = 128 * duration
      $('#bar').width(width)

      // 刻度
      for (let i = 0; i <= parseInt(duration); i++) {
        $('#bar').append(`<div class="absolute" style="left: ${i * 128}px">${i}</div>`)
      }

      // checkpoints
      $('#bar').append(`<img style="left: ${2.74931 * 128}px" class="-ml-5 inline-block h-10 w-10 rounded-full absolute top-3 shadow-sm" src="/checkpoint.png" alt="">`)
      $('#bar').append(`<img style="left: ${4.770224 * 128}px" class="-ml-5 inline-block h-10 w-10 rounded-full absolute top-3 shadow-sm" src="/checkpoint.png" alt="">`)
      $('#bar').append(`<img style="left: ${7.376379 * 128}px" class="-ml-5 inline-block h-10 w-10 rounded-full absolute top-3 shadow-sm" src="/checkpoint.png" alt="">`)
      $('#bar').append(`<img style="left: ${8.632821 * 128}px" class="-ml-5 inline-block h-10 w-10 rounded-full absolute top-3 shadow-sm" src="/checkpoint.png" alt="">`)
      $('#bar').append(`<img style="left: ${10.529329 * 128}px" class="-ml-5 inline-block h-10 w-10 rounded-full absolute top-3 shadow-sm" src="/checkpoint.png" alt="">`)
      $('#bar').append(`<img style="left: ${12.612903 * 128}px" class="-ml-5 inline-block h-10 w-10 rounded-full absolute top-3 shadow-sm" src="/checkpoint.png" alt="">`)
      $('#bar').append(`<img style="left: ${15.099057 * 128}px" class="-ml-5 inline-block h-10 w-10 rounded-full absolute top-3 shadow-sm" src="/checkpoint.png" alt="">`)

      $('#v').get(0).play()

      setInterval(function () {
        const video = $('#v').get(0)
        const currentTime = video.currentTime
        $('#fullbar').css("left", -128 * currentTime);
      }, 30);

      // $('#v').on('timeupdate', function () {
      //   const video = $('#v').get(0)
      //   const currentTime = video.currentTime
      //   $('#fullbar').css("left", -128 * currentTime);
      // })
    })
  </script>
</body>

</html>